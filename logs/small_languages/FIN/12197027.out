learning rate: 8e-6 treshold: 0.4 batch: 7 epochs: 5
Namespace(batch=7, checkpoint='../multilabel/fin', epochs=5, full=False, lang='fin', learning=8e-06, model='TurkuNLP/bert-base-finnish-cased-v1', multilingual=False, saved='saved_models/all_multilingual', test_set=['old-datasets/multilingual-register-data-new/main_labels_only/fi_test.tsv'], train_set=['AfterDeepL/main_labels_only/FIN_FINAL.modified.tsv.gz'], treshold=0.4)
Downloading and preparing dataset csv/default to /users/annieske/.cache/huggingface/datasets/csv/default-8e1413cbe613b17f/0.0.0/433e0ccc46f9880962cc2b12065189766fbb2bee57a221866138fb9203c83519...
Dataset csv downloaded and prepared to /users/annieske/.cache/huggingface/datasets/csv/default-8e1413cbe613b17f/0.0.0/433e0ccc46f9880962cc2b12065189766fbb2bee57a221866138fb9203c83519. Subsequent calls will reuse this data.
Downloading and preparing dataset csv/default to /users/annieske/.cache/huggingface/datasets/csv/default-6c197acc181325b9/0.0.0/433e0ccc46f9880962cc2b12065189766fbb2bee57a221866138fb9203c83519...
Dataset csv downloaded and prepared to /users/annieske/.cache/huggingface/datasets/csv/default-6c197acc181325b9/0.0.0/433e0ccc46f9880962cc2b12065189766fbb2bee57a221866138fb9203c83519. Subsequent calls will reuse this data.
{'dev': Dataset({
    features: ['text', 'label'],
    num_rows: 1294
}),
 'test': Dataset({
    features: ['text', 'label'],
    num_rows: 1498
}),
 'train': Dataset({
    features: ['text', 'label'],
    num_rows: 5176
})}
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
{'loss': 0.3041, 'learning_rate': 6.4e-06, 'epoch': 1.0}
{'eval_loss': 0.2479141503572464, 'eval_f1': 0.6734028683181226, 'eval_roc_auc': 0.7959222107543203, 'eval_accuracy': 0.527047913446677, 'eval_runtime': 13.0832, 'eval_samples_per_second': 98.905, 'eval_steps_per_second': 3.134, 'epoch': 1.0}
{'loss': 0.2231, 'learning_rate': 4.8e-06, 'epoch': 2.0}
{'eval_loss': 0.23138192296028137, 'eval_f1': 0.674842558833278, 'eval_roc_auc': 0.7933353385616756, 'eval_accuracy': 0.5378670788253478, 'eval_runtime': 13.1422, 'eval_samples_per_second': 98.461, 'eval_steps_per_second': 3.12, 'epoch': 2.0}
{'loss': 0.1861, 'learning_rate': 3.2e-06, 'epoch': 3.0}
{'eval_loss': 0.22313031554222107, 'eval_f1': 0.7058445728965961, 'eval_roc_auc': 0.8175127340508478, 'eval_accuracy': 0.5533230293663061, 'eval_runtime': 13.1502, 'eval_samples_per_second': 98.402, 'eval_steps_per_second': 3.118, 'epoch': 3.0}
{'loss': 0.1599, 'learning_rate': 1.6e-06, 'epoch': 4.0}
{'eval_loss': 0.22162091732025146, 'eval_f1': 0.711821887739103, 'eval_roc_auc': 0.8264335184553332, 'eval_accuracy': 0.5533230293663061, 'eval_runtime': 13.141, 'eval_samples_per_second': 98.471, 'eval_steps_per_second': 3.12, 'epoch': 4.0}
{'loss': 0.1422, 'learning_rate': 0.0, 'epoch': 5.0}
{'eval_loss': 0.2232256531715393, 'eval_f1': 0.715862503941974, 'eval_roc_auc': 0.8274635024333602, 'eval_accuracy': 0.5602782071097373, 'eval_runtime': 13.1466, 'eval_samples_per_second': 98.429, 'eval_steps_per_second': 3.119, 'epoch': 5.0}
{'train_runtime': 954.3026, 'train_samples_per_second': 27.119, 'train_steps_per_second': 3.877, 'train_loss': 0.20308349815574853, 'epoch': 5.0}
F1: 0.7048934253977784
              precision    recall  f1-score   support

          IN       0.73      0.40      0.52       103
          NA       0.88      0.67      0.76       209
          HI       0.56      0.73      0.63       320
          LY       0.11      0.78      0.19        18
          IP       1.00      0.20      0.33         5
          SP       0.77      0.91      0.83       661
          ID       0.69      0.57      0.62       246
          OP       0.45      0.33      0.38        15

   micro avg       0.67      0.74      0.70      1577
   macro avg       0.65      0.57      0.53      1577
weighted avg       0.72      0.74      0.72      1577
 samples avg       0.70      0.76      0.71      1577

END: ke 22.6.2022 10.49.47 +0300
