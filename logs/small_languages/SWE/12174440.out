learning rate: 8e-6 treshold: 0.5 batch: 8 epochs: 3
Namespace(batch=8, checkpoint='../multilabel/swe', epochs=3, lang='swetransfer', learning=8e-06, multilingual=False, saved='saved_models/all_multilingual', test_set=['old-datasets/multilingual-register-data-new/main_labels_only/swe_test.formatted_modified.tsv'], train_set=['downsampled/main_labels_only/en_train.downsampled_modified.tsv', 'downsampled/main_labels_only/fre_train.downsampled_modified.tsv', 'downsampled/main_labels_only/fi_train.downsampled_modified.tsv'], treshold=0.5)
Downloading and preparing dataset csv/default to /users/annieske/.cache/huggingface/datasets/csv/default-3d81522d0bc5daf6/0.0.0/433e0ccc46f9880962cc2b12065189766fbb2bee57a221866138fb9203c83519...
Dataset csv downloaded and prepared to /users/annieske/.cache/huggingface/datasets/csv/default-3d81522d0bc5daf6/0.0.0/433e0ccc46f9880962cc2b12065189766fbb2bee57a221866138fb9203c83519. Subsequent calls will reuse this data.
{'dev': Dataset({
    features: ['text', 'label'],
    num_rows: 1401
}),
 'test': Dataset({
    features: ['text', 'label'],
    num_rows: 1177
}),
 'train': Dataset({
    features: ['text', 'label'],
    num_rows: 5601
})}
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
{'loss': 0.2829, 'learning_rate': 5.333333333333333e-06, 'epoch': 1.0}
{'eval_loss': 0.1924520879983902, 'eval_f1': 0.7231335788416472, 'eval_roc_auc': 0.8141238778080188, 'eval_accuracy': 0.6031406138472519, 'eval_runtime': 43.9308, 'eval_samples_per_second': 31.891, 'eval_steps_per_second': 1.002, 'epoch': 1.0}
{'loss': 0.1787, 'learning_rate': 2.6666666666666664e-06, 'epoch': 2.0}
{'eval_loss': 0.17597141861915588, 'eval_f1': 0.7550175215036635, 'eval_roc_auc': 0.8435225149287078, 'eval_accuracy': 0.6409707351891506, 'eval_runtime': 44.084, 'eval_samples_per_second': 31.78, 'eval_steps_per_second': 0.998, 'epoch': 2.0}
{'loss': 0.1431, 'learning_rate': 0.0, 'epoch': 3.0}
{'eval_loss': 0.1760348081588745, 'eval_f1': 0.7616954474097332, 'eval_roc_auc': 0.8510762379656335, 'eval_accuracy': 0.6545324768022841, 'eval_runtime': 44.2279, 'eval_samples_per_second': 31.677, 'eval_steps_per_second': 0.995, 'epoch': 3.0}
{'train_runtime': 1927.4995, 'train_samples_per_second': 8.718, 'train_steps_per_second': 1.091, 'train_loss': 0.20155946130249197, 'epoch': 3.0}
F1: 0.7023437499999999
              precision    recall  f1-score   support

          IN       0.65      0.66      0.66        77
          NA       0.61      0.76      0.68        51
          HI       0.66      0.86      0.75       318
          LY       0.98      0.43      0.59       396
          IP       0.91      0.67      0.77        15
          SP       0.85      0.71      0.78       392
          ID       0.77      0.52      0.62       138
          OP       0.71      0.71      0.71         7

   micro avg       0.77      0.64      0.70      1394
   macro avg       0.77      0.67      0.70      1394
weighted avg       0.82      0.64      0.69      1394
 samples avg       0.74      0.69      0.70      1394

